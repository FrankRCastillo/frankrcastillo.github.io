<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
        <html lang="en">
        <style>
        body  {font-size: 11px; font-family: "Lucida Console", Monaco, monospace; }
        </style>
        <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
        <script>
        document.body = document.createElement("body");

        var c = new Array(9);
        for (i = 0; i < 9; i++) {
                c[i] = new Array(9);
                for (j = 0; j < 9; j++) {
                        c[i][j] = new Array(9);
                        for (k = 0; k < 9; k++) {
                                c[i][j][k] = k + 1;
                        }
                }
        }
        var x = [[8,0,0,0,0,0,0,0,0]
                ,[0,0,3,6,0,0,0,0,0]
                ,[0,7,0,0,9,0,2,0,0]
                ,[0,5,0,0,0,7,0,0,0]
                ,[0,0,0,0,4,5,7,0,0]
                ,[0,0,0,1,0,0,0,3,0]
                ,[0,0,1,0,0,0,0,6,8]
                ,[0,0,8,5,0,0,0,1,0]
                ,[0,9,0,0,0,0,4,0,0]];

        $("body").append(printArr(x));   
        var sx = solveGame(x, c, true)
        $("body").append(printArr(sx));
  
        function solveGame(game, cube, cS) {
                /* While loop performs game checks until the starting game array and the ending game
                are the same, that is, no more changes are made. This may mean that there is a total
                solution, while in others, a partial solution was found. Total and partial solutions
                will have different follow-on actions occur. */
                var oldGame;
                var newGame;
                var gameChg = true;
                while (gameChg == true) {
                        for (i = 0; i < 9; i++) {
                                for (j = 0; j < 9; j++) {
                                        if (game[i][j] != 0) cube[i][j].length = 0;
                                        for (k = 0; k < 9; k++) {
                                                /* Spot checks the game cell and the layers of the cube that corresponds
                                                to that i,j coordinate. */
                                                if (cube[i][j].length == 1) game[i][j] = cube[i][j][k];
                                                for (z = 0; z < 9; z++) {
                                                        /* Vertical & horizontal array check between game cell, checking */
                                                        if (game[i][j] == cube[z][j][k]) cube[z][j].splice(k,1);
                                                        if (game[i][j] == cube[i][z][k]) cube[i][z].splice(k,1);
                                                }
                                        }
                                }
                        }

                        /* Square check iterates through the active game cell and each submatrix and across
                        the entire cube. */
                        for (p = 0; p < 9; p++) {
                                for (q = 0; q < 9; q++) {
                                        switch (true) {
                                                case p >= 0 && p <= 2: var r = 0; break;
                                                case p >= 3 && p <= 5: var r = 3; break;
                                                case p >= 6 && p <= 8: var r = 6; break;
                                        }

                                        switch (true) {
                                                case q >= 0 && q <= 2: var s = 0; break;
                                                case q >= 3 && q <= 5: var s = 3; break;
                                                case q >= 6 && q <= 8: var s = 6; break;
                                        }

                                        for (i = r; i < (3 + r); i++) {
                                                for (j = s; j < (3 + s); j++) {
                                                        for (k = 0; k < cube[p][q].length; k++) {
                                                                if (game[i][j] == cube[p][q][k]) cube[p][q].splice(k,1);
                                                        }
                                                }
                                        }
                                }
                        }

                        //If no changes from the beginning of the loop and the end of the loop occur, it stops
                        newGame = game.toString();
                        if(oldGame == newGame) gameChg = false;
                        oldGame = newGame;
                }

                /* if the game isn't solved then find the first element then
                find the first element with more than one candidate answer. */

                if (cS == true && isSolved(game)[1] == false) {
                        var i = cube.length
                        while (i--) {
                                var j = cube[i].length
                                while (j--) {
                                        if (game[i][j] == 0) {
                                                var k = cube[i][j].length;
                                                while (k--) {
                                                        var pGame = copySqr(game);
                                                        var pCube = copyCbe(cube);
                                                        pGame[i][j] = cube[i][j][k];
                                                        pGame = solveGame(pGame, pCube, false)
                                                        if (isSolved(pGame)[1] == true) {
                                                                console.log(pGame);
                                                                return pGame
                                                        } else {
                                                                console.log(pGame);
                                                                game = pGame;
                                                        }
                                                }
                                        }
                                }
                        }
                } else {
                        console.log(game);
                        return game;
                        
                }

        }
        
        /*Returns Sudoku games in HTML. If there is a
        zero/blank space, it'll be highlighted in red. */
        function printArr(inArr) {
                var output = "<table>";
                var arr;
                if (inArr && inArr.length) {
                        arr = inArr;
                } else {
                        return "output error";
                };
                var i = arr.length;
                while (i--) {
                        output += "<tr>";
                        var j = arr[i].length;
                        while (j--) {
                                var front = "";
                                var end = "";
                                if (arr[i][j] == 0) {
                                        var front = "<font color='red'><b>";
                                        var end = "</font></b>";
                                }
                                output += "<td>[" + front + arr[i][j] + end + "]</td>";
                        }
                        output += "</tr>";
                }
                output += "</table><br/>";
                return output;
        }
        
        /*Returns an array with the game and an second element:
        0 if the game is solved, 1 if not*/
        function isSolved(arr) {
                var solvedGame = 0;
                var i = arr.length;
                while (i--) {
                        var j = arr[i].length;
                        while (j--) {
                                solvedGame += arr[i][j];
                        }
                }
                if (solvedGame == 405) {
                        return [arr, true];
                } else {
                        return [arr, false];
                }
        }
        
        /*Returns a copy of a two-dimensional array*/
        function copySqr(arr) {
                var rtnArr = new Array(9);
                for (i = 0; i < arr.length; i++) {
                        rtnArr[i] = new Array(arr[i].length);
                        for (j = 0; j < arr[i].length; j++) {
                                rtnArr[i][j] = arr[i][j];
                        }               
                }
                return rtnArr;
        }
        
        function copyCbe(arr) {
                var rtnArr = new Array(9);
                for (i = 0; i < arr.length; i++) {
                        rtnArr[i] = new Array(arr[i].length);
                        for (j = 0; j < arr[i].length; j++) {
                                rtnArr[i][j] = new Array(arr[i][j].length);
                                for (j = 0; j < arr[i][j].length; j++) {
                                        rtnArr[i][j][k] = arr[i][j][k];
                                }
                        }
                }
                return rtnArr;
        }
        </script>
</html>
